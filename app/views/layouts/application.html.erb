<!DOCTYPE html>
<html>
  <head>
    <title>InsuranceApp</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  </head>
  <body class="bg-light">
    <%= render 'layouts/nav' %>
    <%= yield %>
    <%= render 'layouts/footer' %>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Change the ID to whatever you give the form element
  $('.zip_form').submit(function(e) {
      e.preventDefault();
      // Get the zip from the form element, since it's the only input element.
      // Generally if you have more than one input, you can just use $(this).serialize()
      // and assign it to a variable that you then send as the 'data' property in the 
      // ensuing Ajax call.
      let zip = $('#inputZipCode').val();
      // Ajax call. Since we're just doing a GET request where the zip is built into 
      // the request URL, there's no reason to add a 'data' property to the request object.
      $.ajax({
          method: 'get',
          url: 'https://www.zipcodeapi.com/rest/KLurgxJ2JSHeRzVq1Cosopdz61X0fsmWJlCRso2C3iqO8xGFb8E1i0OsvcCF8QmM/info.json/' + zip + '/degrees',
          contentType: 'json',
          success: function(data, status, jqXHR) {
              // All we're doing is assigning the value we want to local storage (basically
              // the browser's cache) so we can retrieve it later.
              window.sessionStorage.setItem('userCity', data.city);
              window.location.href = '/page2.html';
          }
      });
  });
});
</script>

  
  </body>
</html>
